---
import { getCollection } from 'astro:content';
import orderBy from 'lodash/orderBy';
import ArticleCard from '@/components/molecules/ArticleCard/ArticleCard.astro';

interface Props {
  anchorId?: string;
  count?: number;
  cta?: CtaModel;
  title?: string;
}

const { anchorId, count = Infinity, cta, title } = Astro.props;

const items = await getCollection('articles', (entry) => !entry.data.draft);
const slice = orderBy(items, ['data.date'], ['desc']).slice(0, count);
---

<section id={anchorId} class="mx-auto my-[max(64px,4vw)] max-w-[80ch] px-4">
  {title && <h2 class="mb-[1em] text-center font-bold text-3xl">{title}</h2>}
  <ul class="flex flex-col gap-x-4 gap-y-6">
    {
      slice.map((entry) => (
        <li class="flex flex-col">
          <ArticleCard entry={entry} />
        </li>
      ))
    }
  </ul>
  {
    cta && (
      <div class="mt-8 flex place-content-center place-items-center">
        <a
          class="inline-block scale-100 rounded bg-primary-700 px-5 py-3 font-bold text-white subpixel-antialiased transition will-change-transform text-base hover:scale-110 hover:bg-primary-600"
          href={cta.url}
          target={cta.target}
        >
          {cta.text}
        </a>
      </div>
    )
  }
</section>
